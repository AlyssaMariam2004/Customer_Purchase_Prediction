2025-06-05 10:19:21,010 - INFO - CSV updated, total rows: 24905
2025-06-05 10:19:23,806 - INFO - Model retrained.
2025-06-05 10:25:10,561 - INFO - CSV updated, total rows: 24925
2025-06-05 10:25:13,347 - INFO - Model retrained.
2025-06-05 10:25:58,838 - INFO - CSV updated, total rows: 24945
2025-06-05 10:26:01,716 - INFO - Model retrained.
2025-06-05 10:40:16,296 - INFO - CSV updated, total rows: 24905
2025-06-05 10:40:18,908 - INFO - Model retrained.
2025-06-05 10:41:42,693 - INFO - CSV updated, total rows: 24925
2025-06-05 10:41:45,670 - INFO - Model retrained.
2025-06-05 10:42:21,614 - INFO - CSV updated, total rows: 24925
2025-06-05 10:42:24,341 - INFO - Model retrained.
2025-06-05 10:42:30,830 - INFO - CSV updated, total rows: 24925
2025-06-05 10:42:33,537 - INFO - Model retrained.
2025-06-05 10:42:39,778 - INFO - CSV updated, total rows: 24925
2025-06-05 10:42:41,398 - INFO - Model retrained.
2025-06-05 10:42:45,718 - INFO - CSV updated, total rows: 24925
2025-06-05 10:42:48,423 - INFO - Model retrained.
2025-06-05 12:04:08,390 - INFO - CSV updated, total rows: 24925
2025-06-05 12:04:12,586 - INFO - Model retrained.
2025-06-05 12:07:32,285 - INFO - CSV updated, total rows: 24925
2025-06-05 12:07:34,987 - INFO - Model retrained.
2025-06-05 12:27:41,349 - INFO - CSV updated, total rows: 24925
2025-06-05 12:27:41,451 - INFO - Starting feature preparation.
2025-06-05 12:27:44,242 - INFO - Optimal clusters found: 2
2025-06-05 12:27:44,261 - INFO - Assigned clusters for 1002 customers.
2025-06-05 12:27:44,265 - INFO - Model retrained.
2025-06-05 12:29:03,873 - INFO - CSV updated, total rows: 24925
2025-06-05 12:29:03,954 - INFO - Starting feature preparation.
2025-06-05 12:29:06,560 - INFO - Optimal clusters found: 2
2025-06-05 12:29:06,581 - INFO - Assigned clusters for 1002 customers.
2025-06-05 12:29:06,585 - INFO - Model retrained.
2025-06-05 12:29:23,529 - INFO - CSV updated, total rows: 24925
2025-06-05 12:29:23,602 - INFO - Starting feature preparation.
2025-06-05 12:29:26,245 - INFO - Optimal clusters found: 2
2025-06-05 12:29:26,260 - INFO - Assigned clusters for 1002 customers.
2025-06-05 12:29:26,260 - INFO - Model retrained.
2025-06-05 12:32:14,568 - INFO - CSV updated, total rows: 24925
2025-06-05 12:32:14,641 - INFO - Starting feature preparation.
2025-06-05 12:32:17,147 - INFO - Optimal clusters found: 2
2025-06-05 12:32:17,158 - INFO - Assigned clusters for 1002 customers.
2025-06-05 12:32:17,162 - INFO - Model retrained.
2025-06-05 12:34:15,555 - INFO - CSV updated, total rows: 24925
2025-06-05 12:34:15,626 - INFO - Starting feature preparation.
2025-06-05 12:34:18,176 - INFO - Optimal clusters found: 2
2025-06-05 12:34:18,188 - INFO - Assigned clusters for 1002 customers.
2025-06-05 12:34:18,192 - INFO - Model retrained.
2025-06-06 09:28:29,136 - INFO - CSV updated, total rows: 24905
2025-06-06 09:28:29,224 - INFO - Starting feature preparation.
2025-06-06 09:28:32,242 - INFO - Optimal clusters found: 2
2025-06-06 09:28:32,248 - INFO - Assigned clusters for 1002 customers.
2025-06-06 09:28:32,264 - INFO - Model retrained.
2025-06-06 09:29:15,663 - INFO - Generating recommendations for Customer ID: CUST_NEW001
2025-06-06 09:29:15,731 - INFO - Recommendations for CUST_NEW001: ['Product_168', 'Product_169', 'Product_173', 'Product_113', 'Product_190']
2025-06-06 09:29:26,157 - INFO - Generating recommendations for Customer ID: CUST_123456
2025-06-06 09:29:26,157 - WARNING - Customer ID CUST_123456 not found in data.
2025-06-06 09:29:35,400 - INFO - Generating recommendations for Customer ID: CUST_001
2025-06-06 09:29:35,409 - WARNING - Customer ID CUST_001 not found in data.
2025-06-06 09:29:41,395 - INFO - Generating recommendations for Customer ID: CUST_001
2025-06-06 09:29:41,395 - WARNING - Customer ID CUST_001 not found in data.
2025-06-06 09:29:53,534 - INFO - Generating recommendations for Customer ID: CUST_123
2025-06-06 09:29:53,534 - WARNING - Customer ID CUST_123 not found in data.
2025-06-06 09:31:09,058 - INFO - Generating recommendations for Customer ID: CUST_008
2025-06-06 09:31:09,058 - WARNING - Customer ID CUST_008 not found in data.
2025-06-06 09:32:27,048 - INFO - Generating recommendations for Customer ID: CUST008
2025-06-06 09:32:27,127 - INFO - Recommendations for CUST008: ['Product_119', 'Product_176', 'Product_073', 'Product_008', 'Product_081']
2025-06-06 09:32:33,191 - INFO - Generating recommendations for Customer ID: CUST001
2025-06-06 09:32:33,273 - INFO - Recommendations for CUST001: ['Product_004', 'Product_117', 'Product_073', 'Product_041', 'Product_016']
2025-06-06 09:53:11,281 - INFO - CSV updated, total rows: 24925
2025-06-06 09:53:11,361 - INFO - Starting feature preparation.
2025-06-06 09:53:14,131 - INFO - Optimal clusters found: 2
2025-06-06 09:53:14,147 - INFO - Assigned clusters for 1002 customers.
2025-06-06 09:53:14,149 - INFO - Model retrained.
2025-06-06 09:53:19,749 - INFO - CSV updated, total rows: 24925
2025-06-06 09:53:19,822 - INFO - Starting feature preparation.
2025-06-06 09:53:20,948 - INFO - Optimal clusters found: 2
2025-06-06 09:53:20,959 - INFO - Assigned clusters for 1002 customers.
2025-06-06 09:53:20,966 - INFO - Model retrained.
2025-06-06 09:53:25,873 - INFO - CSV updated, total rows: 24925
2025-06-06 09:53:25,951 - INFO - Starting feature preparation.
2025-06-06 09:53:28,550 - INFO - Optimal clusters found: 2
2025-06-06 09:53:28,572 - INFO - Assigned clusters for 1002 customers.
2025-06-06 09:53:28,576 - INFO - Model retrained.
2025-06-06 10:03:03,847 - INFO - CSV updated, total rows: 24925
2025-06-06 10:03:03,921 - INFO - Starting feature preparation.
2025-06-06 10:03:06,429 - INFO - Optimal clusters found: 2
2025-06-06 10:03:06,438 - INFO - Assigned clusters for 1002 customers.
2025-06-06 10:03:06,448 - INFO - Model retrained.
2025-06-06 10:06:42,251 - INFO - CSV updated, total rows: 24925
2025-06-06 10:06:42,411 - INFO - Starting feature preparation.
2025-06-06 10:06:45,012 - INFO - Optimal clusters found: 2
2025-06-06 10:06:45,025 - INFO - Assigned clusters for 1002 customers.
2025-06-06 10:06:45,030 - INFO - Model retrained.
2025-06-06 10:08:05,346 - INFO - CSV updated, total rows: 24925
2025-06-06 10:08:05,418 - INFO - Starting feature preparation.
2025-06-06 10:08:08,161 - INFO - Optimal clusters found: 2
2025-06-06 10:08:08,174 - INFO - Assigned clusters for 1002 customers.
2025-06-06 10:08:08,176 - INFO - Model retrained.
2025-06-06 10:13:42,407 - INFO - CSV updated, total rows: 24925
2025-06-06 10:13:42,485 - INFO - Starting feature preparation.
2025-06-06 10:13:45,105 - INFO - Optimal clusters found: 2
2025-06-06 10:13:45,123 - INFO - Assigned clusters for 1002 customers.
2025-06-06 10:13:45,125 - INFO - Model retrained.
2025-06-06 10:15:22,478 - INFO - CSV updated, total rows: 24925
2025-06-06 10:15:22,576 - INFO - Starting feature preparation.
2025-06-06 10:15:25,270 - INFO - Optimal clusters found: 2
2025-06-06 10:15:25,284 - INFO - Assigned clusters for 1002 customers.
2025-06-06 10:15:25,288 - INFO - Model retrained.
2025-06-06 10:17:31,702 - INFO - CSV updated, total rows: 24925
2025-06-06 10:17:31,804 - INFO - Starting feature preparation.
2025-06-06 10:17:34,516 - INFO - Optimal clusters found: 2
2025-06-06 10:17:34,529 - INFO - Assigned clusters for 1002 customers.
2025-06-06 10:17:34,534 - INFO - Model retrained.
2025-06-06 10:18:37,146 - INFO - CSV updated, total rows: 24925
2025-06-06 10:18:37,285 - INFO - Starting feature preparation.
2025-06-06 10:18:39,894 - INFO - Optimal clusters found: 2
2025-06-06 10:18:39,907 - INFO - Assigned clusters for 1002 customers.
2025-06-06 10:18:39,907 - INFO - Model retrained.
2025-06-06 10:19:32,844 - INFO - CSV created.
2025-06-06 10:19:32,864 - INFO - Starting feature preparation.
2025-06-06 10:19:35,024 - INFO - Optimal clusters found: 2
2025-06-06 10:19:35,032 - INFO - Assigned clusters for 5 customers.
2025-06-06 10:19:35,034 - INFO - Model retrained.
2025-06-06 10:20:52,479 - INFO - CSV updated, total rows: 40
2025-06-06 10:20:52,497 - INFO - Starting feature preparation.
2025-06-06 10:20:54,629 - INFO - Optimal clusters found: 2
2025-06-06 10:20:54,636 - INFO - Assigned clusters for 5 customers.
2025-06-06 10:20:54,636 - INFO - Model retrained.
2025-06-06 10:22:32,219 - INFO - CSV updated, total rows: 40
2025-06-06 10:22:32,227 - INFO - Starting feature preparation.
2025-06-06 10:22:34,326 - INFO - Optimal clusters found: 2
2025-06-06 10:22:34,332 - INFO - Assigned clusters for 5 customers.
2025-06-06 10:22:34,334 - INFO - Model retrained.
2025-06-06 10:23:33,049 - INFO - CSV created.
2025-06-06 10:23:33,053 - INFO - Starting feature preparation.
2025-06-06 10:23:35,254 - INFO - Optimal clusters found: 2
2025-06-06 10:23:35,261 - INFO - Assigned clusters for 5 customers.
2025-06-06 10:23:35,331 - INFO - Model retrained.
2025-06-08 18:20:02,245 - INFO - CSV updated, total rows: 40
2025-06-08 18:20:02,256 - INFO - Starting feature preparation.
2025-06-08 18:20:04,079 - INFO - Optimal clusters found: 2
2025-06-08 18:20:04,082 - INFO - Assigned clusters for 5 customers.
2025-06-08 18:20:04,083 - INFO - Model retrained.
2025-06-08 18:44:59,516 - INFO - CSV updated, total rows: 24905
2025-06-08 18:44:59,560 - INFO - Starting feature preparation.
2025-06-08 18:45:01,464 - INFO - Optimal clusters found: 2
2025-06-08 18:45:01,487 - INFO - Assigned clusters for 1002 customers.
2025-06-08 18:45:01,489 - INFO - Model retrained.
2025-06-08 18:49:23,246 - INFO - CSV updated, total rows: 24925
2025-06-08 18:49:23,285 - INFO - Starting feature preparation.
2025-06-08 18:49:25,211 - INFO - Optimal clusters found: 2
2025-06-08 18:49:25,225 - INFO - Assigned clusters for 1002 customers.
2025-06-08 18:49:25,228 - INFO - Model retrained.
2025-06-08 18:49:37,026 - INFO - CSV updated, total rows: 24925
2025-06-08 18:49:37,073 - INFO - Starting feature preparation.
2025-06-08 18:49:39,129 - INFO - Optimal clusters found: 2
2025-06-08 18:49:39,139 - INFO - Assigned clusters for 1002 customers.
2025-06-08 18:49:39,143 - INFO - Model retrained.
2025-06-08 18:50:31,721 - INFO - CSV updated, total rows: 24925
2025-06-08 18:50:31,763 - INFO - Starting feature preparation.
2025-06-08 18:50:33,639 - INFO - Optimal clusters found: 2
2025-06-08 18:50:33,648 - INFO - Assigned clusters for 1002 customers.
2025-06-08 18:50:33,650 - INFO - Model retrained.
2025-06-08 18:51:29,122 - INFO - CSV updated, total rows: 24925
2025-06-08 18:51:29,174 - INFO - Starting feature preparation.
2025-06-08 18:51:31,065 - INFO - Optimal clusters found: 2
2025-06-08 18:51:31,075 - INFO - Assigned clusters for 1002 customers.
2025-06-08 18:51:31,081 - INFO - Model retrained.
2025-06-08 18:52:37,394 - INFO - CSV created.
2025-06-08 18:52:37,400 - INFO - Starting feature preparation.
2025-06-08 18:52:39,020 - INFO - Optimal clusters found: 2
2025-06-08 18:52:39,020 - INFO - Assigned clusters for 5 customers.
2025-06-08 18:52:39,024 - INFO - Model retrained.
2025-06-08 18:53:13,042 - INFO - CSV updated, total rows: 40
2025-06-08 18:53:13,045 - INFO - Starting feature preparation.
2025-06-08 18:53:14,607 - INFO - Optimal clusters found: 2
2025-06-08 18:53:14,610 - INFO - Assigned clusters for 5 customers.
2025-06-08 18:53:14,611 - INFO - Model retrained.
2025-06-08 18:57:45,383 - INFO - CSV created.
2025-06-08 18:57:45,398 - INFO - Starting feature preparation.
2025-06-08 18:57:46,941 - INFO - Optimal clusters found: 2
2025-06-08 18:57:46,944 - INFO - Assigned clusters for 5 customers.
2025-06-08 18:57:46,983 - INFO - Model retrained.
2025-06-08 22:14:07,148 - INFO - CSV created.
2025-06-08 22:14:07,173 - INFO - Starting feature preparation.
2025-06-08 22:14:10,291 - INFO - Optimal clusters found: 2
2025-06-08 22:14:10,298 - INFO - Assigned clusters for 5 customers.
2025-06-08 22:14:10,300 - INFO - Model retrained.
2025-06-08 22:18:26,817 - INFO - CSV updated, total rows: 40
2025-06-08 22:18:26,835 - INFO - Starting feature preparation.
2025-06-08 22:18:28,926 - INFO - Optimal clusters found: 2
2025-06-08 22:18:28,933 - INFO - Assigned clusters for 5 customers.
2025-06-08 22:18:28,935 - INFO - Model retrained.
2025-06-08 22:28:30,643 - INFO - No new unique rows found. CSV not updated.
2025-06-08 22:28:30,646 - INFO - Starting feature preparation.
2025-06-08 22:28:32,787 - INFO - Optimal clusters found: 2
2025-06-08 22:28:32,793 - INFO - Assigned clusters for 5 customers.
2025-06-08 22:28:32,795 - INFO - Model retrained.
2025-06-08 22:28:57,281 - INFO - Found existing CSV. Running sync and possible retrain.
2025-06-08 22:28:57,329 - INFO - No new unique rows found. CSV not updated.
2025-06-08 22:28:57,329 - INFO - Starting feature preparation.
2025-06-08 22:28:59,578 - INFO - Optimal clusters found: 2
2025-06-08 22:28:59,584 - INFO - Assigned clusters for 5 customers.
2025-06-08 22:28:59,586 - INFO - Model retrained.
2025-06-08 22:30:24,458 - INFO - Found existing CSV. Running sync and possible retrain.
2025-06-08 22:30:24,576 - INFO - No new unique rows found. CSV not updated.
2025-06-08 22:30:24,638 - INFO - Starting feature preparation.
2025-06-08 22:30:27,366 - INFO - Optimal clusters found: 2
2025-06-08 22:30:27,382 - INFO - Assigned clusters for 1000 customers.
2025-06-08 22:30:27,386 - INFO - Model retrained.
2025-06-08 22:30:58,969 - INFO - Found existing CSV. Running sync and possible retrain.
2025-06-08 22:30:59,093 - INFO - No new unique rows found. CSV not updated.
2025-06-08 22:30:59,143 - INFO - Starting feature preparation.
2025-06-08 22:31:01,605 - INFO - Optimal clusters found: 2
2025-06-08 22:31:01,621 - INFO - Assigned clusters for 1000 customers.
2025-06-08 22:31:01,623 - INFO - Model retrained.
2025-06-08 22:31:38,416 - INFO - Found existing CSV. Running sync and possible retrain.
2025-06-08 22:31:38,545 - INFO - No new unique rows found. CSV not updated.
2025-06-08 22:31:38,596 - INFO - Starting feature preparation.
2025-06-08 22:31:41,107 - INFO - Optimal clusters found: 2
2025-06-08 22:31:41,117 - INFO - Assigned clusters for 1000 customers.
2025-06-08 22:31:41,123 - INFO - Model retrained.
2025-06-08 22:32:57,797 - INFO - Found existing CSV. Running sync and possible retrain.
2025-06-08 22:32:57,913 - INFO - No new unique rows found. CSV not updated.
2025-06-08 22:32:57,977 - INFO - Starting feature preparation.
2025-06-08 22:33:00,577 - INFO - Optimal clusters found: 2
2025-06-08 22:33:00,591 - INFO - Assigned clusters for 1000 customers.
2025-06-08 22:33:00,595 - INFO - Model retrained.
2025-06-08 22:36:50,678 - INFO - Found existing CSV. Running sync and possible retrain.
2025-06-08 22:36:50,803 - INFO - No new unique rows found. CSV not updated.
2025-06-08 22:36:50,861 - INFO - Starting feature preparation.
2025-06-08 22:36:53,400 - INFO - Optimal clusters found: 2
2025-06-08 22:36:53,414 - INFO - Assigned clusters for 1000 customers.
2025-06-08 22:36:53,414 - INFO - Model retrained.
2025-06-08 22:37:09,724 - INFO - Found existing CSV. Running sync and possible retrain.
2025-06-08 22:37:09,844 - INFO - No new unique rows found. CSV not updated.
2025-06-08 22:37:09,904 - INFO - Starting feature preparation.
2025-06-08 22:37:12,427 - INFO - Optimal clusters found: 2
2025-06-08 22:37:12,441 - INFO - Assigned clusters for 1000 customers.
2025-06-08 22:37:12,443 - INFO - Model retrained.
2025-06-08 22:38:50,052 - INFO - Found existing CSV. Running sync and possible retrain.
2025-06-08 22:38:50,115 - INFO - Fetched 20 rows from DB
2025-06-08 22:38:50,167 - INFO - Existing CSV has 24885 rows
2025-06-08 22:38:50,200 - INFO - After deduplication, CSV would have 24905 rows
2025-06-08 22:38:50,364 - INFO - Appended new data and saved CSV.
2025-06-08 22:38:50,433 - INFO - Starting feature preparation.
2025-06-08 22:38:53,009 - INFO - Optimal clusters found: 2
2025-06-08 22:38:53,023 - INFO - Assigned clusters for 1002 customers.
2025-06-08 22:38:53,027 - INFO - Model retrained.
2025-06-08 22:50:11,653 - INFO - Found existing CSV. Running sync and possible retrain.
2025-06-08 22:50:11,704 - INFO - Fetched 20 rows from DB
2025-06-08 22:50:11,761 - INFO - Existing CSV has 24905 rows
2025-06-08 22:50:11,795 - INFO - After deduplication, CSV would have 24925 rows
2025-06-08 22:50:11,958 - INFO - Appended new data and saved CSV.
2025-06-08 22:50:12,039 - INFO - Starting feature preparation.
2025-06-08 22:50:14,643 - INFO - Optimal clusters found: 2
2025-06-08 22:50:14,649 - INFO - Assigned clusters for 1002 customers.
2025-06-08 22:50:14,659 - INFO - Model retrained.
2025-06-08 22:52:15,089 - INFO - Found existing CSV. Running sync and possible retrain.
2025-06-08 22:52:15,146 - INFO - Fetched 20 rows from DB
2025-06-08 22:52:15,195 - INFO - Existing CSV has 24925 rows
2025-06-08 22:52:15,213 - INFO - Dropped 86 duplicates. Final row count: 24859
2025-06-08 22:52:15,213 - INFO - No new unique rows found. CSV not updated.
2025-06-08 22:52:15,258 - INFO - Starting feature preparation.
2025-06-08 22:52:17,880 - INFO - Optimal clusters found: 2
2025-06-08 22:52:17,885 - INFO - Assigned clusters for 1002 customers.
2025-06-08 22:52:17,896 - INFO - Model retrained.
2025-06-08 22:54:56,879 - INFO - Found existing CSV. Running sync and possible retrain.
2025-06-08 22:54:56,932 - INFO - Fetched 20 rows from DB
2025-06-08 22:54:57,007 - INFO - Existing CSV has 24885 rows
2025-06-08 22:54:57,025 - INFO - Dropped 46 duplicates. Final row count: 24859
2025-06-08 22:54:57,025 - INFO - No new unique rows found. CSV not updated.
2025-06-08 22:54:57,081 - INFO - Starting feature preparation.
2025-06-08 22:54:59,578 - INFO - Optimal clusters found: 2
2025-06-08 22:54:59,592 - INFO - Assigned clusters for 1000 customers.
2025-06-08 22:54:59,596 - INFO - Model retrained.
2025-06-08 22:56:14,889 - INFO - Found existing CSV. Running sync and possible retrain.
2025-06-08 22:56:14,947 - INFO - Fetched 20 rows from DB
2025-06-08 22:56:15,011 - INFO - Existing CSV has 24885 rows
2025-06-08 22:56:15,026 - INFO - Dropped 46 duplicates. Final row count: 24859
2025-06-08 22:56:15,026 - INFO - No new unique rows found. CSV not updated.
2025-06-08 22:56:15,075 - INFO - Starting feature preparation.
2025-06-08 22:56:17,640 - INFO - Optimal clusters found: 2
2025-06-08 22:56:17,655 - INFO - Assigned clusters for 1000 customers.
2025-06-08 22:56:17,659 - INFO - Model retrained.
2025-06-08 22:58:22,151 - INFO - Found existing CSV. Running sync and possible retrain.
2025-06-08 22:58:22,208 - INFO - Fetched 20 rows from DB
2025-06-08 22:58:22,276 - INFO - Existing CSV has 24885 rows
2025-06-08 22:58:22,291 - INFO - Dropped 46 duplicates. Final row count: 24859
2025-06-08 22:58:22,291 - INFO - No new unique rows found. CSV not updated.
2025-06-08 22:58:22,357 - INFO - Starting feature preparation.
2025-06-08 22:58:24,934 - INFO - Optimal clusters found: 2
2025-06-08 22:58:24,949 - INFO - Assigned clusters for 1000 customers.
2025-06-08 22:58:24,953 - INFO - Model retrained.
2025-06-08 23:03:52,897 - INFO - Found existing CSV. Running sync and possible retrain.
2025-06-08 23:03:52,952 - INFO - Fetched 20 rows from DB
2025-06-08 23:03:53,010 - INFO - Existing CSV has 24885 rows
2025-06-08 23:03:53,024 - INFO - New unique rows to add: 20
2025-06-08 23:03:53,044 - INFO - Dropped 46 duplicates after concatenation. Final row count: 24859
2025-06-08 23:03:53,208 - INFO - Appended new unique data and saved CSV.
2025-06-08 23:03:53,290 - INFO - Starting feature preparation.
2025-06-08 23:03:56,031 - INFO - Optimal clusters found: 2
2025-06-08 23:03:56,044 - INFO - Assigned clusters for 1002 customers.
2025-06-08 23:03:56,050 - INFO - Model retrained.
2025-06-08 23:16:54,667 - INFO - Generating recommendations for Customer ID: CUST001
2025-06-08 23:16:54,716 - INFO - Recommendations for CUST001: ['Product_004', 'Product_117', 'Product_073', 'Product_041', 'Product_016']
2025-06-08 23:17:13,727 - INFO - Generating recommendations for Customer ID: CUST_NEW001
2025-06-08 23:17:13,773 - INFO - Recommendations for CUST_NEW001: ['Product_168', 'Product_169', 'Product_173', 'Product_113', 'Product_190']
2025-06-09 08:45:50,570 - INFO - Found existing CSV. Running sync and possible retrain.
2025-06-09 08:45:50,716 - INFO - Fetched 20 rows from DB
2025-06-09 08:45:50,784 - INFO - Existing CSV has 24859 rows
2025-06-09 08:45:50,821 - INFO - New unique rows to add: 0
2025-06-09 08:45:50,821 - INFO - No new unique rows found in DB. CSV not updated.
2025-06-09 08:45:50,877 - INFO - Starting feature preparation.
2025-06-09 08:45:53,809 - INFO - Optimal clusters found: 2
2025-06-09 08:45:53,815 - INFO - Assigned clusters for 1002 customers.
2025-06-09 08:45:53,833 - INFO - Model retrained.
2025-06-09 08:48:34,994 - INFO - Generating recommendations for Customer ID: string
2025-06-09 08:48:34,994 - WARNING - Customer ID string not found in data.
2025-06-09 08:48:47,068 - INFO - Generating recommendations for Customer ID: CUST001
2025-06-09 08:48:47,152 - INFO - Recommendations for CUST001: ['Product_004', 'Product_117', 'Product_073']
2025-06-09 08:48:57,669 - INFO - Generating recommendations for Customer ID: CUST001
2025-06-09 08:48:57,756 - INFO - Recommendations for CUST001: ['Product_004', 'Product_117', 'Product_073', 'Product_041', 'Product_016']
2025-06-09 20:58:04,375 - INFO - Found existing CSV. Running sync and possible retrain.
2025-06-09 20:58:04,571 - INFO - Starting feature preparation.
2025-06-09 20:58:06,478 - INFO - Optimal clusters found: 2
2025-06-09 20:58:06,482 - INFO - Assigned clusters for 1002 customers.
2025-06-09 20:58:06,489 - INFO - Model retrained.
2025-06-09 21:12:22,548 - INFO - Starting feature preparation.
2025-06-09 21:12:22,859 - INFO - Optimal clusters found: 2
2025-06-09 21:12:22,865 - INFO - Assigned clusters for 1002 customers.
2025-06-09 21:12:22,874 - INFO - Model retrained.
2025-06-09 21:12:22,874 - INFO - Generating recommendations for Customer ID: CUST_NEW100
2025-06-09 21:12:22,874 - WARNING - Customer ID CUST_NEW100 not found in data.
2025-06-09 21:34:00,056 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-09 21:34:00,056 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-09 21:34:00,056 - INFO - Added job "sync_data" to job store "default"
2025-06-09 21:34:00,056 - INFO - Added job "maybe_retrain_model" to job store "default"
2025-06-09 21:34:00,056 - INFO - Scheduler started
2025-06-09 21:34:00,067 - INFO - Background scheduler started.
2025-06-09 21:34:00,067 - INFO - Found existing CSV. Running initial sync and retrain.
2025-06-09 21:34:00,324 - INFO - Starting feature preparation.
2025-06-09 21:34:02,174 - INFO - Optimal clusters found: 9
2025-06-09 21:34:02,195 - INFO - Assigned clusters for 1012 customers.
2025-06-09 21:34:02,198 - INFO - Model retrained.
2025-06-09 21:35:15,200 - INFO - Scheduler has been shut down
2025-06-09 21:35:15,200 - INFO - Scheduler shut down.
2025-06-09 21:35:17,682 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-09 21:35:17,682 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-09 21:35:17,682 - INFO - Added job "sync_data" to job store "default"
2025-06-09 21:35:17,682 - INFO - Added job "maybe_retrain_model" to job store "default"
2025-06-09 21:35:17,682 - INFO - Scheduler started
2025-06-09 21:35:17,689 - INFO - Background scheduler started.
2025-06-09 21:35:17,689 - INFO - Found existing CSV. Running initial sync and retrain.
2025-06-09 21:35:17,918 - INFO - Starting feature preparation.
2025-06-09 21:35:19,878 - INFO - Optimal clusters found: 9
2025-06-09 21:35:19,893 - INFO - Assigned clusters for 1012 customers.
2025-06-09 21:35:19,903 - INFO - Model retrained.
2025-06-10 11:53:02,786 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-10 11:53:02,787 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-10 11:53:02,787 - INFO - Added job "sync_data" to job store "default"
2025-06-10 11:53:02,787 - INFO - Added job "maybe_retrain_model" to job store "default"
2025-06-10 11:53:02,787 - INFO - Scheduler started
2025-06-10 11:53:02,787 - INFO - Background scheduler started.
2025-06-10 11:53:02,787 - INFO - Found existing CSV. Running initial sync and retrain.
2025-06-10 11:53:03,086 - INFO - Starting feature preparation.
2025-06-10 11:53:06,628 - INFO - Optimal clusters found: 9
2025-06-10 11:53:06,641 - INFO - Assigned clusters for 1012 customers.
2025-06-10 11:53:06,647 - INFO - Model retrained.
2025-06-10 12:03:02,797 - INFO - Running job "sync_data (trigger: interval[0:10:00], next run at: 2025-06-10 12:03:02 IST)" (scheduled at 2025-06-10 12:03:02.786072+05:30)
2025-06-10 12:03:02,798 - INFO - Running job "maybe_retrain_model (trigger: interval[0:10:00], next run at: 2025-06-10 12:03:02 IST)" (scheduled at 2025-06-10 12:03:02.786877+05:30)
2025-06-10 12:03:02,853 - INFO - Job "maybe_retrain_model (trigger: interval[0:10:00], next run at: 2025-06-10 12:13:02 IST)" executed successfully
2025-06-10 12:03:03,001 - INFO - Job "sync_data (trigger: interval[0:10:00], next run at: 2025-06-10 12:13:02 IST)" executed successfully
2025-06-10 12:13:02,801 - INFO - Running job "sync_data (trigger: interval[0:10:00], next run at: 2025-06-10 12:23:02 IST)" (scheduled at 2025-06-10 12:13:02.786072+05:30)
2025-06-10 12:13:02,801 - INFO - Running job "maybe_retrain_model (trigger: interval[0:10:00], next run at: 2025-06-10 12:23:02 IST)" (scheduled at 2025-06-10 12:13:02.786877+05:30)
2025-06-10 12:13:02,883 - INFO - Starting feature preparation.
2025-06-10 12:13:03,020 - INFO - Job "sync_data (trigger: interval[0:10:00], next run at: 2025-06-10 12:23:02 IST)" executed successfully
2025-06-10 12:13:03,326 - INFO - Optimal clusters found: 9
2025-06-10 12:13:03,339 - INFO - Assigned clusters for 1012 customers.
2025-06-10 12:13:03,343 - INFO - Model retrained.
2025-06-10 12:13:03,343 - INFO - Job "maybe_retrain_model (trigger: interval[0:10:00], next run at: 2025-06-10 12:23:02 IST)" executed successfully
2025-06-10 12:15:38,259 - INFO - Scheduler has been shut down
2025-06-10 12:15:38,259 - INFO - Scheduler shut down.
2025-06-10 14:08:47,458 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-10 14:08:47,459 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-10 14:08:47,462 - INFO - Added job "sync_data" to job store "default"
2025-06-10 14:08:47,464 - INFO - Added job "maybe_retrain_model" to job store "default"
2025-06-10 14:08:47,464 - INFO - Scheduler started
2025-06-10 14:08:47,467 - INFO - Background scheduler started.
2025-06-10 14:08:47,468 - INFO - Found existing CSV. Running initial sync and retrain.
2025-06-10 14:08:47,979 - INFO - Starting feature preparation.
2025-06-10 14:08:51,000 - INFO - Optimal clusters found: 9
2025-06-10 14:08:51,020 - INFO - Assigned clusters for 1012 customers.
2025-06-10 14:08:51,027 - INFO - Model retrained.
2025-06-10 14:18:47,461 - INFO - Running job "sync_data (trigger: interval[0:10:00], next run at: 2025-06-10 14:18:47 IST)" (scheduled at 2025-06-10 14:18:47.458972+05:30)
2025-06-10 14:18:47,462 - INFO - Running job "maybe_retrain_model (trigger: interval[0:10:00], next run at: 2025-06-10 14:18:47 IST)" (scheduled at 2025-06-10 14:18:47.459973+05:30)
2025-06-10 14:18:47,544 - INFO - Job "maybe_retrain_model (trigger: interval[0:10:00], next run at: 2025-06-10 14:28:47 IST)" executed successfully
2025-06-10 14:18:47,873 - INFO - Job "sync_data (trigger: interval[0:10:00], next run at: 2025-06-10 14:28:47 IST)" executed successfully
2025-06-10 14:20:45,433 - INFO - Starting feature preparation.
2025-06-10 14:20:45,953 - INFO - Optimal clusters found: 9
2025-06-10 14:20:45,976 - INFO - Assigned clusters for 1012 customers.
2025-06-10 14:20:45,982 - INFO - Model retrained.
2025-06-10 14:20:45,983 - INFO - Generating recommendations for Customer ID: CUST001
2025-06-10 14:20:46,048 - INFO - Recommendations for CUST001: ['Product_190', 'Product_178', 'Product_073', 'Product_081', 'Product_117']
2025-06-10 14:28:47,467 - INFO - Running job "sync_data (trigger: interval[0:10:00], next run at: 2025-06-10 14:38:47 IST)" (scheduled at 2025-06-10 14:28:47.458972+05:30)
2025-06-10 14:28:47,468 - INFO - Running job "maybe_retrain_model (trigger: interval[0:10:00], next run at: 2025-06-10 14:38:47 IST)" (scheduled at 2025-06-10 14:28:47.459973+05:30)
2025-06-10 14:28:47,550 - INFO - Job "maybe_retrain_model (trigger: interval[0:10:00], next run at: 2025-06-10 14:38:47 IST)" executed successfully
2025-06-10 14:28:47,894 - INFO - Job "sync_data (trigger: interval[0:10:00], next run at: 2025-06-10 14:38:47 IST)" executed successfully
2025-06-10 14:38:47,466 - INFO - Running job "sync_data (trigger: interval[0:10:00], next run at: 2025-06-10 14:48:47 IST)" (scheduled at 2025-06-10 14:38:47.458972+05:30)
2025-06-10 14:38:47,467 - INFO - Running job "maybe_retrain_model (trigger: interval[0:10:00], next run at: 2025-06-10 14:48:47 IST)" (scheduled at 2025-06-10 14:38:47.459973+05:30)
2025-06-10 14:38:47,626 - INFO - Starting feature preparation.
2025-06-10 14:38:47,849 - INFO - Job "sync_data (trigger: interval[0:10:00], next run at: 2025-06-10 14:48:47 IST)" executed successfully
2025-06-10 14:38:48,345 - INFO - Optimal clusters found: 9
2025-06-10 14:38:48,365 - INFO - Assigned clusters for 1012 customers.
2025-06-10 14:38:48,371 - INFO - Model retrained.
2025-06-10 14:38:48,372 - INFO - Job "maybe_retrain_model (trigger: interval[0:10:00], next run at: 2025-06-10 14:48:47 IST)" executed successfully
2025-06-10 14:48:47,463 - INFO - Running job "sync_data (trigger: interval[0:10:00], next run at: 2025-06-10 14:58:47 IST)" (scheduled at 2025-06-10 14:48:47.458972+05:30)
2025-06-10 14:48:47,464 - INFO - Running job "maybe_retrain_model (trigger: interval[0:10:00], next run at: 2025-06-10 14:58:47 IST)" (scheduled at 2025-06-10 14:48:47.459973+05:30)
2025-06-10 14:48:47,573 - INFO - Job "maybe_retrain_model (trigger: interval[0:10:00], next run at: 2025-06-10 14:58:47 IST)" executed successfully
2025-06-10 14:48:47,884 - INFO - Job "sync_data (trigger: interval[0:10:00], next run at: 2025-06-10 14:58:47 IST)" executed successfully
2025-06-10 14:51:46,553 - INFO - Starting feature preparation.
2025-06-10 14:51:47,154 - INFO - Optimal clusters found: 9
2025-06-10 14:51:47,175 - INFO - Assigned clusters for 1012 customers.
2025-06-10 14:51:47,181 - INFO - Model retrained.
2025-06-10 14:51:47,183 - INFO - Generating recommendations for Customer ID: CUST001
2025-06-10 14:51:47,235 - INFO - Recommendations for CUST001: ['Product_190', 'Product_178', 'Product_073', 'Product_081', 'Product_117']
2025-06-10 14:52:29,688 - INFO - Generating recommendations for Customer ID: CUST1234567
2025-06-10 14:52:29,688 - WARNING - Customer ID CUST1234567 not found in data.
2025-06-10 14:58:47,470 - INFO - Running job "sync_data (trigger: interval[0:10:00], next run at: 2025-06-10 15:08:47 IST)" (scheduled at 2025-06-10 14:58:47.458972+05:30)
2025-06-10 14:58:47,470 - INFO - Running job "maybe_retrain_model (trigger: interval[0:10:00], next run at: 2025-06-10 15:08:47 IST)" (scheduled at 2025-06-10 14:58:47.459973+05:30)
2025-06-10 14:58:47,547 - INFO - Job "maybe_retrain_model (trigger: interval[0:10:00], next run at: 2025-06-10 15:08:47 IST)" executed successfully
2025-06-10 14:58:47,812 - INFO - Job "sync_data (trigger: interval[0:10:00], next run at: 2025-06-10 15:08:47 IST)" executed successfully
2025-06-10 15:08:47,475 - INFO - Running job "sync_data (trigger: interval[0:10:00], next run at: 2025-06-10 15:18:47 IST)" (scheduled at 2025-06-10 15:08:47.458972+05:30)
2025-06-10 15:08:47,475 - INFO - Running job "maybe_retrain_model (trigger: interval[0:10:00], next run at: 2025-06-10 15:18:47 IST)" (scheduled at 2025-06-10 15:08:47.459973+05:30)
2025-06-10 15:08:47,693 - INFO - Starting feature preparation.
2025-06-10 15:08:48,018 - INFO - Job "sync_data (trigger: interval[0:10:00], next run at: 2025-06-10 15:18:47 IST)" executed successfully
2025-06-10 15:08:48,513 - INFO - Optimal clusters found: 9
2025-06-10 15:08:48,536 - INFO - Assigned clusters for 1012 customers.
2025-06-10 15:08:48,543 - INFO - Model retrained.
2025-06-10 15:08:48,545 - INFO - Job "maybe_retrain_model (trigger: interval[0:10:00], next run at: 2025-06-10 15:18:47 IST)" executed successfully
2025-06-10 15:18:47,470 - INFO - Running job "sync_data (trigger: interval[0:10:00], next run at: 2025-06-10 15:28:47 IST)" (scheduled at 2025-06-10 15:18:47.458972+05:30)
2025-06-10 15:18:47,471 - INFO - Running job "maybe_retrain_model (trigger: interval[0:10:00], next run at: 2025-06-10 15:28:47 IST)" (scheduled at 2025-06-10 15:18:47.459973+05:30)
2025-06-10 15:18:47,549 - INFO - Job "maybe_retrain_model (trigger: interval[0:10:00], next run at: 2025-06-10 15:28:47 IST)" executed successfully
2025-06-10 15:18:47,789 - INFO - Job "sync_data (trigger: interval[0:10:00], next run at: 2025-06-10 15:28:47 IST)" executed successfully
2025-06-10 15:18:51,291 - INFO - Scheduler has been shut down
2025-06-10 15:18:51,292 - INFO - Scheduler shut down.
2025-06-12 12:06:12 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-12 12:06:12 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-12 12:06:12 - INFO - Starting scheduler service...
2025-06-12 12:06:12 - INFO - Starting data sync...
2025-06-12 12:06:12 - INFO - Fetched 30 new rows.
2025-06-12 12:06:13 - INFO - Data synced. Current total: 24945 rows.
2025-06-12 12:06:13 - INFO - Preparing features for clustering.
2025-06-12 12:06:15 - INFO - Model retrained.
2025-06-12 12:06:15 - INFO - Added job "sync_data" to job store "default"
2025-06-12 12:06:15 - INFO - Added job "maybe_retrain_model" to job store "default"
2025-06-12 12:06:15 - INFO - Scheduler started
2025-06-12 12:06:15 - WARNING - Run time of job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-12 12:06:12 IST)" was missed by 0:00:02.480461
2025-06-12 12:06:17 - INFO - Running job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-12 12:08:17 IST)" (scheduled at 2025-06-12 12:06:17.845007+05:30)
2025-06-12 12:06:17 - INFO - Job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-12 12:08:17 IST)" executed successfully
2025-06-12 12:08:12 - INFO - Running job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-12 12:10:12 IST)" (scheduled at 2025-06-12 12:08:12.845007+05:30)
2025-06-12 12:08:12 - INFO - Starting data sync...
2025-06-12 12:08:12 - INFO - Fetched 30 new rows.
2025-06-12 12:08:12 - INFO - Data synced. Current total: 24945 rows.
2025-06-12 12:08:12 - INFO - Job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-12 12:10:12 IST)" executed successfully
2025-06-12 12:08:17 - INFO - Running job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-12 12:10:17 IST)" (scheduled at 2025-06-12 12:08:17.845007+05:30)
2025-06-12 12:08:17 - INFO - Job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-12 12:10:17 IST)" executed successfully
2025-06-12 12:10:12 - INFO - Running job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-12 12:12:12 IST)" (scheduled at 2025-06-12 12:10:12.845007+05:30)
2025-06-12 12:10:12 - INFO - Starting data sync...
2025-06-12 12:10:12 - INFO - Fetched 30 new rows.
2025-06-12 12:10:12 - INFO - Data synced. Current total: 24945 rows.
2025-06-12 12:10:12 - INFO - Job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-12 12:12:12 IST)" executed successfully
2025-06-12 12:10:17 - INFO - Running job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-12 12:12:17 IST)" (scheduled at 2025-06-12 12:10:17.845007+05:30)
2025-06-12 12:10:17 - INFO - Job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-12 12:12:17 IST)" executed successfully
2025-06-12 12:12:12 - INFO - Running job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-12 12:14:12 IST)" (scheduled at 2025-06-12 12:12:12.845007+05:30)
2025-06-12 12:12:12 - INFO - Starting data sync...
2025-06-12 12:12:12 - INFO - Fetched 30 new rows.
2025-06-12 12:12:12 - INFO - Data synced. Current total: 24945 rows.
2025-06-12 12:12:12 - INFO - Job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-12 12:14:12 IST)" executed successfully
2025-06-12 12:12:17 - INFO - Running job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-12 12:14:17 IST)" (scheduled at 2025-06-12 12:12:17.845007+05:30)
2025-06-12 12:12:17 - INFO - Job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-12 12:14:17 IST)" executed successfully
2025-06-12 12:14:12 - INFO - Running job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-12 12:16:12 IST)" (scheduled at 2025-06-12 12:14:12.845007+05:30)
2025-06-12 12:14:12 - INFO - Starting data sync...
2025-06-12 12:14:12 - INFO - Fetched 30 new rows.
2025-06-12 12:14:12 - INFO - Data synced. Current total: 24945 rows.
2025-06-12 12:14:12 - INFO - Job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-12 12:16:12 IST)" executed successfully
2025-06-12 12:14:17 - INFO - Running job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-12 12:16:17 IST)" (scheduled at 2025-06-12 12:14:17.845007+05:30)
2025-06-12 12:14:17 - INFO - Job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-12 12:16:17 IST)" executed successfully
2025-06-12 12:14:44 - INFO - Loaded pickled model.
2025-06-12 12:14:44 - INFO - Loaded pickled model.
2025-06-12 13:01:24 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-12 13:01:24 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-12 13:01:24 - INFO - Starting scheduler...
2025-06-12 13:01:24 - INFO - Starting data sync...
2025-06-12 13:01:24 - INFO - Merged dataset now has 24945 rows.
2025-06-12 13:01:25 - INFO - Data sync complete and written to CSV.
2025-06-12 13:01:25 - INFO - Preparing features for clustering.
2025-06-12 13:01:27 - INFO - Feature preparation and clustering completed.
2025-06-12 13:01:27 - INFO - Model saved to DF_PATH and MODEL_PATH.
2025-06-12 13:01:27 - INFO - Removed old model backup: df_20250612_130127.pkl
2025-06-12 13:01:27 - INFO - Removed old model backup: df_20250612_120615.pkl
2025-06-12 13:01:27 - INFO - Model retrained successfully.
2025-06-12 13:01:27 - INFO - Added job "sync_data" to job store "default"
2025-06-12 13:01:27 - INFO - Added job "maybe_retrain_model" to job store "default"
2025-06-12 13:01:27 - INFO - Scheduler started
2025-06-12 13:01:27 - WARNING - Run time of job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-12 13:01:24 IST)" was missed by 0:00:02.599347
2025-06-12 13:01:29 - INFO - Running job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-12 13:03:29 IST)" (scheduled at 2025-06-12 13:01:29.877549+05:30)
2025-06-12 13:01:29 - INFO - No retraining needed at this time.
2025-06-12 13:01:29 - INFO - Job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-12 13:03:29 IST)" executed successfully
2025-06-12 13:05:42 - INFO - Pickled model and data loaded successfully.
2025-06-12 13:05:42 - INFO - Detected model change. Reloading...
2025-06-12 13:05:42 - INFO - Pickled model and data loaded successfully.
2025-06-12 13:11:10 - INFO - Loaded pickled model and dataframe.
2025-06-12 13:11:10 - INFO - Detected model change. Reloading...
2025-06-12 13:11:10 - INFO - Loaded pickled model and dataframe.
2025-06-12 13:11:27 - ERROR - Error during recommendation generation.
Traceback (most recent call last):
  File "C:\Customer_Purchase_Prediction\app\recommender.py", line 34, in recommend_products
    if customer_id not in final_df.index:
TypeError: argument of type 'builtin_function_or_method' is not iterable
2025-06-12 13:11:39 - ERROR - Error during recommendation generation.
Traceback (most recent call last):
  File "C:\Customer_Purchase_Prediction\app\recommender.py", line 34, in recommend_products
    if customer_id not in final_df.index:
TypeError: argument of type 'builtin_function_or_method' is not iterable
2025-06-12 16:20:41 - INFO - Loaded pickled model and dataframe.
2025-06-12 16:20:41 - INFO - Detected model change. Reloading...
2025-06-12 16:20:41 - INFO - Loaded pickled model and dataframe.
2025-06-12 16:20:56 - ERROR - Error during recommendation generation.
Traceback (most recent call last):
  File "C:\Customer_Purchase_Prediction\app\recommender.py", line 34, in recommend_products
    if customer_id not in final_df.index:
TypeError: argument of type 'builtin_function_or_method' is not iterable
2025-06-12 16:26:07 - INFO - Loaded pickled model and dataframe.
2025-06-12 16:26:07 - INFO - Detected model change. Reloading...
2025-06-12 16:26:07 - INFO - Loaded pickled model and dataframe.
2025-06-12 16:26:26 - ERROR - Error during recommendation generation.
Traceback (most recent call last):
  File "C:\Customer_Purchase_Prediction\app\recommender.py", line 35, in recommend_products
    if customer_id not in final_df.index:
TypeError: argument of type 'builtin_function_or_method' is not iterable
2025-06-12 16:29:35 - ERROR - Loaded object from MODEL_PATH is not a DataFrame.
2025-06-12 16:29:35 - ERROR - Failed to load pickle files.
Traceback (most recent call last):
  File "C:\Customer_Purchase_Prediction\app\recommender.py", line 27, in load_pickled_data
    raise ValueError("Invalid format: final_df must be a pandas DataFrame.")
ValueError: Invalid format: final_df must be a pandas DataFrame.
2025-06-12 16:29:35 - ERROR - Error during app startup: Error loading pickled data: Invalid format: final_df must be a pandas DataFrame.
2025-06-12 16:35:32 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-12 16:35:32 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-12 16:35:32 - INFO - Starting scheduler...
2025-06-12 16:35:32 - INFO - Starting data sync...
2025-06-12 16:35:32 - INFO - Merged dataset now has 24945 rows.
2025-06-12 16:35:32 - INFO - Data sync complete and written to CSV.
2025-06-12 16:35:32 - INFO - Triggering retraining based on threshold.
2025-06-12 16:35:32 - INFO - Preparing features for clustering.
2025-06-12 16:35:35 - INFO - Feature preparation and clustering completed.
2025-06-12 16:35:35 - ERROR - Error during retrain_model: prepare_features must return a pandas DataFrame.
2025-06-12 16:35:35 - INFO - Added job "sync_data" to job store "default"
2025-06-12 16:35:35 - INFO - Added job "maybe_retrain_model" to job store "default"
2025-06-12 16:35:35 - INFO - Scheduler started
2025-06-12 16:35:35 - WARNING - Run time of job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-12 16:35:32 IST)" was missed by 0:00:03.200879
2025-06-12 16:35:37 - INFO - Running job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-12 16:37:37 IST)" (scheduled at 2025-06-12 16:35:37.514751+05:30)
2025-06-12 16:35:37 - INFO - Triggering retraining based on threshold.
2025-06-12 16:35:37 - INFO - Preparing features for clustering.
2025-06-12 16:35:38 - INFO - Feature preparation and clustering completed.
2025-06-12 16:35:38 - ERROR - Error during retrain_model: prepare_features must return a pandas DataFrame.
2025-06-12 16:35:38 - INFO - Job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-12 16:37:37 IST)" executed successfully
2025-06-12 16:37:32 - INFO - Running job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-12 16:39:32 IST)" (scheduled at 2025-06-12 16:37:32.514751+05:30)
2025-06-12 16:37:32 - INFO - Starting data sync...
2025-06-12 16:37:32 - INFO - Merged dataset now has 24945 rows.
2025-06-12 16:37:32 - INFO - Data sync complete and written to CSV.
2025-06-12 16:37:32 - INFO - Job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-12 16:39:32 IST)" executed successfully
2025-06-12 16:37:37 - INFO - Running job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-12 16:39:37 IST)" (scheduled at 2025-06-12 16:37:37.514751+05:30)
2025-06-12 16:37:37 - INFO - Triggering retraining based on threshold.
2025-06-12 16:37:37 - INFO - Preparing features for clustering.
2025-06-12 16:37:38 - INFO - Feature preparation and clustering completed.
2025-06-12 16:37:38 - ERROR - Error during retrain_model: prepare_features must return a pandas DataFrame.
2025-06-12 16:37:38 - INFO - Job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-12 16:39:37 IST)" executed successfully
2025-06-12 16:39:32 - INFO - Running job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-12 16:41:32 IST)" (scheduled at 2025-06-12 16:39:32.514751+05:30)
2025-06-12 16:39:32 - INFO - Starting data sync...
2025-06-12 16:39:32 - INFO - Merged dataset now has 24945 rows.
2025-06-12 16:39:32 - INFO - Data sync complete and written to CSV.
2025-06-12 16:39:32 - INFO - Job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-12 16:41:32 IST)" executed successfully
2025-06-12 16:39:37 - INFO - Running job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-12 16:41:37 IST)" (scheduled at 2025-06-12 16:39:37.514751+05:30)
2025-06-12 16:39:37 - INFO - Triggering retraining based on threshold.
2025-06-12 16:39:37 - INFO - Preparing features for clustering.
2025-06-12 16:39:38 - INFO - Feature preparation and clustering completed.
2025-06-12 16:39:38 - ERROR - Error during retrain_model: prepare_features must return a pandas DataFrame.
2025-06-12 16:39:38 - INFO - Job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-12 16:41:37 IST)" executed successfully
2025-06-12 16:44:22 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-12 16:44:22 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-12 16:44:22 - INFO - Starting scheduler...
2025-06-12 16:44:22 - INFO - Starting data sync...
2025-06-12 16:44:23 - INFO - Merged dataset now has 24945 rows.
2025-06-12 16:44:23 - INFO - Data sync complete and written to CSV.
2025-06-12 16:44:23 - INFO - Triggering retraining based on threshold.
2025-06-12 16:44:23 - INFO - Preparing features for clustering.
2025-06-12 16:44:26 - INFO - Feature preparation and clustering completed.
2025-06-12 16:44:26 - INFO - Model saved to DF_PATH and MODEL_PATH.
2025-06-12 16:44:26 - INFO - Removed old model backup: final_df_20250612_120615.pkl
2025-06-12 16:44:26 - INFO - Removed old model backup: df_20250612_164426.pkl
2025-06-12 16:44:26 - INFO - Model retrained successfully.
2025-06-12 16:44:26 - INFO - Added job "sync_data" to job store "default"
2025-06-12 16:44:26 - INFO - Added job "maybe_retrain_model" to job store "default"
2025-06-12 16:44:26 - INFO - Scheduler started
2025-06-12 16:44:26 - WARNING - Run time of job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-12 16:44:22 IST)" was missed by 0:00:03.229723
2025-06-12 16:44:27 - INFO - Running job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-12 16:46:27 IST)" (scheduled at 2025-06-12 16:44:27.929194+05:30)
2025-06-12 16:44:27 - INFO - No retraining needed at this time.
2025-06-12 16:44:27 - INFO - Job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-12 16:46:27 IST)" executed successfully
2025-06-12 16:44:50 - INFO - Loaded pickled model and dataframe successfully.
2025-06-12 16:44:50 - INFO - Detected model change. Reloading...
2025-06-12 16:44:50 - INFO - Loaded pickled model and dataframe successfully.
2025-06-12 16:45:15 - WARNING - Invalid CustomerID requested: CUST001234567
2025-06-12 19:08:23 - INFO - Successfully loaded pickled data and model.
2025-06-12 19:08:23 - INFO - Detected model change. Reloading model...
2025-06-12 19:08:23 - INFO - Successfully loaded pickled data and model.
2025-06-12 19:08:29 - WARNING - Requested Customer ID not found: CUST001234567
2025-06-12 19:18:02 - INFO - Successfully loaded pickled data and model.
2025-06-12 19:18:02 - INFO - Detected model change. Reloading model...
2025-06-12 19:18:02 - INFO - Successfully loaded pickled data and model.
2025-06-12 19:21:23 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-12 19:21:23 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-12 19:21:23 - INFO - Scheduler starting...
2025-06-12 19:21:23 - INFO - Starting data sync from database to CSV...
2025-06-12 19:21:23 - INFO - Merged dataset now contains 24945 rows.
2025-06-12 19:21:24 - INFO - Data successfully written to CSV.
2025-06-12 19:21:24 - INFO - Triggering retraining based on threshold.
2025-06-12 19:21:24 - INFO - Preparing features for clustering.
2025-06-12 19:21:27 - INFO - Feature preparation and clustering completed.
2025-06-12 19:21:27 - INFO - Model saved to DF_PATH and MODEL_PATH.
2025-06-12 19:21:27 - INFO - Removed old model backup: final_df_20250612_130127.pkl
2025-06-12 19:21:27 - INFO - Removed old model backup: df_20250612_192127.pkl
2025-06-12 19:21:27 - INFO - Model retrained successfully.
2025-06-12 19:21:27 - INFO - Added job "sync_data" to job store "default"
2025-06-12 19:21:27 - INFO - Added job "maybe_retrain_model" to job store "default"
2025-06-12 19:21:27 - INFO - Scheduler started
2025-06-12 19:21:27 - WARNING - Run time of job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-12 19:21:23 IST)" was missed by 0:00:03.430785
2025-06-12 19:21:28 - INFO - Running job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-12 19:23:28 IST)" (scheduled at 2025-06-12 19:21:28.691676+05:30)
2025-06-12 19:21:28 - INFO - No retraining needed at this time.
2025-06-12 19:21:28 - INFO - Job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-12 19:23:28 IST)" executed successfully
2025-06-13 13:36:10 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-13 13:36:10 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-13 13:36:10 - INFO - Scheduler starting...
2025-06-13 13:36:10 - INFO - Starting data sync from database to CSV...
2025-06-13 13:36:11 - INFO - No existing CSV found. Creating a new dataset from fetched data.
2025-06-13 13:36:11 - INFO - Data successfully written to CSV.
2025-06-13 13:36:11 - INFO - Triggering retraining based on threshold.
2025-06-13 13:36:11 - INFO - Preparing features for clustering.
2025-06-13 13:36:13 - INFO - Feature preparation and clustering completed.
2025-06-13 13:36:13 - INFO - Model saved to DF_PATH and MODEL_PATH.
2025-06-13 13:36:13 - INFO - Removed old model backup: final_df_20250612_164426.pkl
2025-06-13 13:36:13 - INFO - Removed old model backup: df_20250613_133613.pkl
2025-06-13 13:36:13 - INFO - Model retrained successfully.
2025-06-13 13:36:13 - INFO - Added job "sync_data" to job store "default"
2025-06-13 13:36:13 - INFO - Added job "maybe_retrain_model" to job store "default"
2025-06-13 13:36:13 - INFO - Scheduler started
2025-06-13 13:36:13 - WARNING - Run time of job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 13:36:10 IST)" was missed by 0:00:02.501427
2025-06-13 13:36:15 - INFO - Running job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 13:38:15 IST)" (scheduled at 2025-06-13 13:36:15.849961+05:30)
2025-06-13 13:36:15 - INFO - No retraining needed at this time.
2025-06-13 13:36:15 - INFO - Job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 13:38:15 IST)" executed successfully
2025-06-13 13:37:17 - WARNING - Pickle files not found.
2025-06-13 13:37:17 - ERROR - Failed to load pickled files.
Traceback (most recent call last):
  File "C:\Customer_Purchase_Prediction\app\recommender.py", line 48, in load_pickled_data
    raise FileNotFoundError("Pickled model or data file not found.")
FileNotFoundError: Pickled model or data file not found.
2025-06-13 13:37:17 - ERROR - [Startup] Failed during application lifespan: Error loading pickled data: Pickled model or data file not found.
2025-06-13 13:37:52 - ERROR - Model data not loaded before recommendation request.
2025-06-13 13:38:10 - INFO - Running job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 13:40:10 IST)" (scheduled at 2025-06-13 13:38:10.849961+05:30)
2025-06-13 13:38:10 - INFO - Starting data sync from database to CSV...
2025-06-13 13:38:10 - INFO - Merged dataset now contains 60 rows.
2025-06-13 13:38:10 - INFO - Data successfully written to CSV.
2025-06-13 13:38:10 - INFO - Job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 13:40:10 IST)" executed successfully
2025-06-13 13:38:15 - INFO - Running job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 13:40:15 IST)" (scheduled at 2025-06-13 13:38:15.849961+05:30)
2025-06-13 13:38:15 - INFO - Triggering retraining based on threshold.
2025-06-13 13:38:15 - INFO - Preparing features for clustering.
2025-06-13 13:38:15 - INFO - Feature preparation and clustering completed.
2025-06-13 13:38:15 - INFO - Model saved to DF_PATH and MODEL_PATH.
2025-06-13 13:38:16 - INFO - Removed old model backup: final_df_20250612_192127.pkl
2025-06-13 13:38:16 - INFO - Removed old model backup: df_20250613_133815.pkl
2025-06-13 13:38:16 - INFO - Model retrained successfully.
2025-06-13 13:38:16 - INFO - Job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 13:40:15 IST)" executed successfully
2025-06-13 13:38:17 - ERROR - Model data not loaded before recommendation request.
2025-06-13 13:39:10 - ERROR - Model data not loaded before recommendation request.
2025-06-13 13:55:13 - WARNING - Pickle files not found.
2025-06-13 13:55:13 - ERROR - Failed to load pickled files.
Traceback (most recent call last):
  File "C:\Customer_Purchase_Prediction\app\recommender.py", line 48, in load_pickled_data
    raise FileNotFoundError("Pickled model or data file not found.")
FileNotFoundError: Pickled model or data file not found.
2025-06-13 13:55:13 - ERROR - [Startup] Failed during application lifespan: Error loading pickled data: Pickled model or data file not found.
2025-06-13 13:56:59 - WARNING - Pickle files not found.
2025-06-13 13:56:59 - ERROR - Failed to load pickled files.
Traceback (most recent call last):
  File "C:\Customer_Purchase_Prediction\app\recommender.py", line 48, in load_pickled_data
    raise FileNotFoundError("Pickled model or data file not found.")
FileNotFoundError: Pickled model or data file not found.
2025-06-13 13:56:59 - ERROR - [Startup] Failed during application lifespan: Error loading pickled data: Pickled model or data file not found.
2025-06-13 13:57:50 - WARNING - Pickle files not found.
2025-06-13 13:57:50 - ERROR - Failed to load pickled files.
Traceback (most recent call last):
  File "C:\Customer_Purchase_Prediction\app\recommender.py", line 48, in load_pickled_data
    raise FileNotFoundError("Pickled model or data file not found.")
FileNotFoundError: Pickled model or data file not found.
2025-06-13 13:57:50 - ERROR - [Startup] Failed during application lifespan: Error loading pickled data: Pickled model or data file not found.
2025-06-13 14:02:09 - WARNING - Pickle files not found.
2025-06-13 14:02:09 - ERROR - Failed to load pickled files.
Traceback (most recent call last):
  File "C:\Customer_Purchase_Prediction\app\recommender.py", line 48, in load_pickled_data
    raise FileNotFoundError("Pickled model or data file not found.")
FileNotFoundError: Pickled model or data file not found.
2025-06-13 14:02:09 - ERROR - [Startup] Failed during application lifespan: Error loading pickled data: Pickled model or data file not found.
2025-06-13 14:02:19 - ERROR - Model data not loaded before recommendation request.
2025-06-13 14:02:32 - ERROR - Model data not loaded before recommendation request.
2025-06-13 14:08:19 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-13 14:08:19 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-13 14:08:19 - INFO - Scheduler starting...
2025-06-13 14:08:19 - INFO - Starting data sync from database to CSV...
2025-06-13 14:08:19 - INFO - No existing CSV found. Creating a new dataset from fetched data.
2025-06-13 14:08:19 - INFO - Data successfully written to CSV.
2025-06-13 14:08:19 - INFO - Triggering retraining based on threshold.
2025-06-13 14:08:19 - INFO - Preparing features for clustering.
2025-06-13 14:08:21 - INFO - Feature preparation and clustering completed.
2025-06-13 14:08:21 - INFO - Model saved to DF_PATH and MODEL_PATH.
2025-06-13 14:08:21 - INFO - Removed old model backup: final_df_20250613_133613.pkl
2025-06-13 14:08:21 - INFO - Removed old model backup: df_20250613_140821.pkl
2025-06-13 14:08:21 - INFO - Model retrained successfully.
2025-06-13 14:08:21 - INFO - Added job "sync_data" to job store "default"
2025-06-13 14:08:21 - INFO - Added job "maybe_retrain_model" to job store "default"
2025-06-13 14:08:21 - INFO - Scheduler started
2025-06-13 14:08:21 - WARNING - Run time of job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 14:08:19 IST)" was missed by 0:00:02.277789
2025-06-13 14:08:24 - INFO - Running job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:10:24 IST)" (scheduled at 2025-06-13 14:08:24.583055+05:30)
2025-06-13 14:08:24 - INFO - No retraining needed at this time.
2025-06-13 14:08:24 - INFO - Job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:10:24 IST)" executed successfully
2025-06-13 14:10:19 - INFO - Running job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 14:12:19 IST)" (scheduled at 2025-06-13 14:10:19.583055+05:30)
2025-06-13 14:10:19 - INFO - Starting data sync from database to CSV...
2025-06-13 14:10:19 - INFO - Merged dataset now contains 60 rows.
2025-06-13 14:10:19 - INFO - Data successfully written to CSV.
2025-06-13 14:10:19 - INFO - Job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 14:12:19 IST)" executed successfully
2025-06-13 14:10:24 - INFO - Running job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:12:24 IST)" (scheduled at 2025-06-13 14:10:24.583055+05:30)
2025-06-13 14:10:24 - INFO - Triggering retraining based on threshold.
2025-06-13 14:10:24 - INFO - Preparing features for clustering.
2025-06-13 14:10:24 - INFO - Feature preparation and clustering completed.
2025-06-13 14:10:24 - INFO - Model saved to DF_PATH and MODEL_PATH.
2025-06-13 14:10:24 - INFO - Removed old model backup: final_df_20250613_133815.pkl
2025-06-13 14:10:24 - INFO - Removed old model backup: df_20250613_141024.pkl
2025-06-13 14:10:24 - INFO - Model retrained successfully.
2025-06-13 14:10:24 - INFO - Job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:12:24 IST)" executed successfully
2025-06-13 14:10:43 - WARNING - Pickle files not found.
2025-06-13 14:10:43 - ERROR - Failed to load pickled files.
Traceback (most recent call last):
  File "C:\Customer_Purchase_Prediction\app\recommender.py", line 48, in load_pickled_data
    raise FileNotFoundError("Pickled model or data file not found.")
FileNotFoundError: Pickled model or data file not found.
2025-06-13 14:10:43 - ERROR - [Startup] Failed during application lifespan: Error loading pickled data: Pickled model or data file not found.
2025-06-13 14:11:02 - ERROR - Model data not loaded before recommendation request.
2025-06-13 14:12:19 - INFO - Running job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 14:14:19 IST)" (scheduled at 2025-06-13 14:12:19.583055+05:30)
2025-06-13 14:12:19 - INFO - Starting data sync from database to CSV...
2025-06-13 14:12:19 - INFO - Merged dataset now contains 60 rows.
2025-06-13 14:12:19 - INFO - Data successfully written to CSV.
2025-06-13 14:12:19 - INFO - Job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 14:14:19 IST)" executed successfully
2025-06-13 14:12:24 - INFO - Running job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:14:24 IST)" (scheduled at 2025-06-13 14:12:24.583055+05:30)
2025-06-13 14:12:24 - INFO - No retraining needed at this time.
2025-06-13 14:12:24 - INFO - Job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:14:24 IST)" executed successfully
2025-06-13 14:14:19 - INFO - Running job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 14:16:19 IST)" (scheduled at 2025-06-13 14:14:19.583055+05:30)
2025-06-13 14:14:19 - INFO - Starting data sync from database to CSV...
2025-06-13 14:14:19 - INFO - Merged dataset now contains 60 rows.
2025-06-13 14:14:19 - INFO - Data successfully written to CSV.
2025-06-13 14:14:19 - INFO - Job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 14:16:19 IST)" executed successfully
2025-06-13 14:14:24 - INFO - Running job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:16:24 IST)" (scheduled at 2025-06-13 14:14:24.583055+05:30)
2025-06-13 14:14:24 - INFO - No retraining needed at this time.
2025-06-13 14:14:24 - INFO - Job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:16:24 IST)" executed successfully
2025-06-13 14:16:19 - INFO - Running job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 14:18:19 IST)" (scheduled at 2025-06-13 14:16:19.583055+05:30)
2025-06-13 14:16:19 - INFO - Starting data sync from database to CSV...
2025-06-13 14:16:19 - INFO - Merged dataset now contains 60 rows.
2025-06-13 14:16:19 - INFO - Data successfully written to CSV.
2025-06-13 14:16:19 - INFO - Job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 14:18:19 IST)" executed successfully
2025-06-13 14:16:24 - INFO - Running job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:18:24 IST)" (scheduled at 2025-06-13 14:16:24.583055+05:30)
2025-06-13 14:16:24 - INFO - No retraining needed at this time.
2025-06-13 14:16:24 - INFO - Job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:18:24 IST)" executed successfully
2025-06-13 14:18:57 - WARNING - Run time of job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 14:20:19 IST)" was missed by 0:00:38.078374
2025-06-13 14:18:57 - WARNING - Run time of job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:18:24 IST)" was missed by 0:00:33.079503
2025-06-13 14:20:19 - INFO - Running job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 14:22:19 IST)" (scheduled at 2025-06-13 14:20:19.583055+05:30)
2025-06-13 14:20:19 - INFO - Starting data sync from database to CSV...
2025-06-13 14:20:19 - INFO - Merged dataset now contains 60 rows.
2025-06-13 14:20:19 - INFO - Data successfully written to CSV.
2025-06-13 14:20:19 - INFO - Job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 14:22:19 IST)" executed successfully
2025-06-13 14:20:24 - INFO - Running job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:22:24 IST)" (scheduled at 2025-06-13 14:20:24.583055+05:30)
2025-06-13 14:20:24 - INFO - No retraining needed at this time.
2025-06-13 14:20:24 - INFO - Job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:22:24 IST)" executed successfully
2025-06-13 14:23:08 - WARNING - Run time of job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 14:24:19 IST)" was missed by 0:00:49.088754
2025-06-13 14:23:08 - WARNING - Run time of job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:24:24 IST)" was missed by 0:00:44.088754
2025-06-13 14:24:19 - INFO - Running job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 14:26:19 IST)" (scheduled at 2025-06-13 14:24:19.583055+05:30)
2025-06-13 14:24:19 - INFO - Starting data sync from database to CSV...
2025-06-13 14:24:19 - INFO - Merged dataset now contains 60 rows.
2025-06-13 14:24:19 - INFO - Data successfully written to CSV.
2025-06-13 14:24:19 - INFO - Job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 14:26:19 IST)" executed successfully
2025-06-13 14:24:24 - INFO - Running job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:26:24 IST)" (scheduled at 2025-06-13 14:24:24.583055+05:30)
2025-06-13 14:24:24 - INFO - Triggering retraining based on threshold.
2025-06-13 14:24:24 - INFO - Preparing features for clustering.
2025-06-13 14:24:24 - INFO - Feature preparation and clustering completed.
2025-06-13 14:24:24 - INFO - Model saved to DF_PATH and MODEL_PATH.
2025-06-13 14:24:24 - INFO - Removed old model backup: final_df_20250613_140821.pkl
2025-06-13 14:24:24 - INFO - Removed old model backup: df_20250613_142424.pkl
2025-06-13 14:24:24 - INFO - Model retrained successfully.
2025-06-13 14:24:24 - INFO - Job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:26:24 IST)" executed successfully
2025-06-13 14:33:00 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-13 14:33:00 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-06-13 14:33:00 - INFO - Scheduler starting...
2025-06-13 14:33:00 - INFO - Starting data sync from database to CSV...
2025-06-13 14:33:00 - INFO - Merged dataset now contains 24945 rows.
2025-06-13 14:33:01 - INFO - Data successfully written to CSV.
2025-06-13 14:33:01 - INFO - Triggering retraining based on threshold.
2025-06-13 14:33:01 - INFO - Preparing features for clustering.
2025-06-13 14:33:03 - INFO - Feature preparation and clustering completed.
2025-06-13 14:33:03 - INFO - Model saved to DF_PATH and MODEL_PATH.
2025-06-13 14:33:03 - INFO - Removed old model backup: final_df_20250613_141024.pkl
2025-06-13 14:33:04 - INFO - Removed old model backup: df_20250613_143303.pkl
2025-06-13 14:33:04 - INFO - Model retrained successfully.
2025-06-13 14:33:04 - INFO - Added job "sync_data" to job store "default"
2025-06-13 14:33:04 - INFO - Added job "maybe_retrain_model" to job store "default"
2025-06-13 14:33:04 - INFO - Scheduler started
2025-06-13 14:33:04 - WARNING - Run time of job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 14:33:00 IST)" was missed by 0:00:03.183040
2025-06-13 14:33:05 - INFO - Running job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:35:05 IST)" (scheduled at 2025-06-13 14:33:05.822539+05:30)
2025-06-13 14:33:05 - INFO - No retraining needed at this time.
2025-06-13 14:33:05 - INFO - Job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:35:05 IST)" executed successfully
2025-06-13 14:33:45 - WARNING - Pickle files not found.
2025-06-13 14:33:45 - ERROR - Failed to load pickled files.
Traceback (most recent call last):
  File "C:\Customer_Purchase_Prediction\app\recommender.py", line 48, in load_pickled_data
    raise FileNotFoundError("Pickled model or data file not found.")
FileNotFoundError: Pickled model or data file not found.
2025-06-13 14:33:45 - ERROR - [Startup] Failed during application lifespan: Error loading pickled data: Pickled model or data file not found.
2025-06-13 14:34:04 - ERROR - Model data not loaded before recommendation request.
2025-06-13 14:35:00 - INFO - Running job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 14:37:00 IST)" (scheduled at 2025-06-13 14:35:00.822539+05:30)
2025-06-13 14:35:00 - INFO - Starting data sync from database to CSV...
2025-06-13 14:35:00 - INFO - Merged dataset now contains 24945 rows.
2025-06-13 14:35:01 - INFO - Data successfully written to CSV.
2025-06-13 14:35:01 - INFO - Job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 14:37:00 IST)" executed successfully
2025-06-13 14:35:05 - INFO - Running job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:37:05 IST)" (scheduled at 2025-06-13 14:35:05.822539+05:30)
2025-06-13 14:35:05 - INFO - No retraining needed at this time.
2025-06-13 14:35:05 - INFO - Job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:37:05 IST)" executed successfully
2025-06-13 14:37:00 - INFO - Running job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 14:39:00 IST)" (scheduled at 2025-06-13 14:37:00.822539+05:30)
2025-06-13 14:37:00 - INFO - Starting data sync from database to CSV...
2025-06-13 14:37:00 - INFO - Merged dataset now contains 24945 rows.
2025-06-13 14:37:01 - INFO - Data successfully written to CSV.
2025-06-13 14:37:01 - INFO - Job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 14:39:00 IST)" executed successfully
2025-06-13 14:37:05 - INFO - Running job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:39:05 IST)" (scheduled at 2025-06-13 14:37:05.822539+05:30)
2025-06-13 14:37:05 - INFO - No retraining needed at this time.
2025-06-13 14:37:05 - INFO - Job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:39:05 IST)" executed successfully
2025-06-13 14:39:00 - INFO - Running job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 14:41:00 IST)" (scheduled at 2025-06-13 14:39:00.822539+05:30)
2025-06-13 14:39:00 - INFO - Starting data sync from database to CSV...
2025-06-13 14:39:00 - INFO - Merged dataset now contains 24945 rows.
2025-06-13 14:39:01 - INFO - Data successfully written to CSV.
2025-06-13 14:39:01 - INFO - Job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 14:41:00 IST)" executed successfully
2025-06-13 14:39:05 - INFO - Running job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:41:05 IST)" (scheduled at 2025-06-13 14:39:05.822539+05:30)
2025-06-13 14:39:05 - INFO - No retraining needed at this time.
2025-06-13 14:39:05 - INFO - Job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:41:05 IST)" executed successfully
2025-06-13 14:40:14 - INFO - Successfully loaded pickled data and model.
2025-06-13 14:40:14 - INFO - Detected model change. Reloading model...
2025-06-13 14:40:14 - INFO - Successfully loaded pickled data and model.
2025-06-13 14:40:43 - WARNING - Requested Customer ID not found: CUST12345
2025-06-13 14:41:00 - INFO - Running job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 14:43:00 IST)" (scheduled at 2025-06-13 14:41:00.822539+05:30)
2025-06-13 14:41:00 - INFO - Starting data sync from database to CSV...
2025-06-13 14:41:00 - INFO - Merged dataset now contains 24945 rows.
2025-06-13 14:41:01 - INFO - Data successfully written to CSV.
2025-06-13 14:41:01 - INFO - Job "sync_data (trigger: interval[0:02:00], next run at: 2025-06-13 14:43:00 IST)" executed successfully
2025-06-13 14:41:05 - INFO - Running job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:43:05 IST)" (scheduled at 2025-06-13 14:41:05.822539+05:30)
2025-06-13 14:41:05 - INFO - No retraining needed at this time.
2025-06-13 14:41:05 - INFO - Job "maybe_retrain_model (trigger: interval[0:02:00], next run at: 2025-06-13 14:43:05 IST)" executed successfully
